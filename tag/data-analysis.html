<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Amy Hanlon - data analysis</title>
        <link rel="stylesheet" href="/theme/css/main.css" />

        <!--[if IE]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">Amy Hanlon </a></h1>
                <nav><ul>
                    <li><a href="/pages/bio.html">Biography</a></li>
                    <li><a href="/pages/endorsements.html">Endorsements</a></li>
                    <li><a href="/pages/home.html">Home</a></li>
                    <li><a href="/category/hacker-school.html">Hacker School</a></li>
                    <li><a href="/category/little-eureka-moments.html">Little Eureka Moments</a></li>
                    <li><a href="/category/projects.html">Projects</a></li>
                    <li><a href="/category/uncategorized.html">Uncategorized</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="/ipython-and-pandas-are-whoa.html">ipython and pandas are whoa!</a></h1>
<footer class="post-info">
        <abbr class="published" title="2014-02-14T15:52:00">
                Fri 14 February 2014
        </abbr>

        <address class="vcard author">
                By <a class="url fn" href="/author/amygdalama.html">amygdalama</a>
        </address>
<p>In <a href="/category/projects.html">Projects</a>. </p>
<p>tags: <a href="/tag/data-analysis.html">data analysis</a><a href="/tag/hacker-school.html">hacker school</a><a href="/tag/ipython.html">ipython</a><a href="/tag/matplotlib.html">matplotlib</a><a href="/tag/pandas.html">pandas</a><a href="/tag/python.html">python</a></p>
</footer><!-- /.post-info --><p>In my first five months of using Python, I would create .py files and
then execute them in the terminal, like the loyal follower of <a href="http://learnpythonthehardway.org/book/">LPTHW</a>
that I am. While it's certainly necessary to be able to write Python
scripts and execute them from the terminal, I've learned that this
workflow isn't the best way to explore data in Python.</p>
<p>I initially converted to Python from R, and since have missed the
interactiveness of working within RStudio (you don't have to re-run your
entire code every time you make a change and want to view the results)
and how R allows you to so quickly get to your data with data frames
built straight from text files. Enter: <a href="http://ipython.org/">ipython</a> and <a href="http://pandas.pydata.org/">pandas</a>. (Go
to their respective sites for installation instructions.)</p>
<p>Julia Evans has a fantastic <a href="https://github.com/jvns/pandas-cookbook">tutorial</a> on how to use pandas in an
ipython notebook. Here, I'd like to explore the differences between
doing data analysis using ipython notebook and pandas versus writing .py
scripts using mainly standard Python packages and executing via the
terminal.</p>
<p>Let's use the classic iris dataset for some simple analysis. First we
need to do some setup. Create a directory for our project (mine is
stored within my Projects directory that I keep in my Home directory.)
In the terminal:</p>
<p>[code lang="bash" gutter="false"]\$ mkdir
\~/Projects/ipython-pandas-whoa<br />
\$ cd \~/Projects[/code]</p>
<p>Then create a Python script and open it with a text editor (I use
Sublime Text 2, which I've <a href="http://www.sublimetext.com/docs/2/osx_command_line.html">configured</a> to open files with the command
<code>subl</code>.</p>
<p>[code lang="bash" gutter="false"]\$ touch barbaric-script.py<br />
\$ subl barbaric-script.py[/code]</p>
<p>This should open up a blank .py file in Sublime. If you don't have
<code>subl</code> set up, you can simply open up the blank barbaric-script.py file
we created with the <code>touch</code> command in your text editor of choice.</p>
<p>In the barbaric-script.py file, let's import the necessary packages.
We'll be using a couple standard python packages plus matplotlib.pyplot.
If you don't have matplotlib installed, you can find installation
instructions <a href="http://matplotlib.org/users/installing.html">here</a>.</p>
<p>[code lang="python"]<br />
import csv<br />
import pprint<br />
import urllib2</p>
<p>import matplotlib.pyplot as plt[/code]</p>
<p>To get the iris data, we'll use Python's built-in urllib2 and csv
packages and then do some basic formatting. Let's process the dataset as
a list of dictionaries.</p>
<p>[code lang="python" firstline="8"]url =
"http://mlr.cs.umass.edu/ml/machine-learning-databases/iris/iris.data"</p>
<p># Open data from URL as a file-like object<br />
f = urllib2.urlopen(url)</p>
<p># Create an empty list to store our data<br />
parsed_data = []</p>
<p># Read file<br />
raw_data = csv.reader(f)</p>
<p># Define our headers since the file doesn't contain explicit headers<br />
# I found these headers from looking at the documentation at<br />
#
http://mlr.cs.umass.edu/ml/machine-learning-databases/iris/iris.names<br />
headers = ['Sepal Length', 'Sepal Width', 'Petal Length', 'Petal
Width', 'Class'<br />
]</p>
<p># Iterate through the rows in the file, and create a dictionary for
each row<br />
for row in raw_data:</p>
<p># Dictionaries should have headers -> row<br />
parsed_data.append(dict(zip(headers, row)))</p>
<p># Delete the last row of parsed_data because it's blank<br />
parsed_data = parsed_data[:-1]</p>
<p># Let's see what parsed_data looks like<br />
pprint.pprint(parsed_data[:3])[/code]</p>
<p>What you should see when you execute barbaric-script.py:</p>
<p>[code language="bash" gutter="false"]\$ python barbaric-script.py<br />
[{'Class': 'Iris-setosa',<br />
'Petal Length': '1.4',<br />
'Petal Width': '0.2',<br />
'Sepal Length': '5.1',<br />
'Sepal Width': '3.5'},<br />
{'Class': 'Iris-setosa',<br />
'Petal Length': '1.4',<br />
'Petal Width': '0.2',<br />
'Sepal Length': '4.9',<br />
'Sepal Width': '3.0'},<br />
{'Class': 'Iris-setosa',<br />
'Petal Length': '1.3',<br />
'Petal Width': '0.2',<br />
'Sepal Length': '4.7',<br />
'Sepal Width': '3.2'}][/code]</p>
<p>Great! So we have our data formatted nicely. We have a list with
elements corresponding to each row in the file, and the elements in the
list are dictionaries. The keys in the dictionaries are the column
headers, and the values are the values associated with the respective
column header for that particular row. For example, the first
row/observation (printed as the first dictionary out of the three listed
above) is in the class Iris-setosa, has a Petal Length of 1.4, a Petal
Width of 0.2, a Sepal Length of 5.1, and a Sepal Width of 3.5. Let's do
some plotting to explore our data. We can make a histogram! Add the
following lines to your barbaric-script.py file:</p>
<p>[code lang="python" firstline="37"]# Let's create a list of the Sepal
Lengths<br />
# I'm calling float on the entries because otherwise they're stored as
strings<br />
sepal_lengths = [float(parsed_data[i]['Sepal Length'])<br />
for i in range(len(parsed_data))]</p>
<p>plt.hist(sepal_lengths, color='#348ABD', edgecolor='none')<br />
plt.xlabel('Sepal Length')<br />
plt.ylabel('Count')<br />
plt.show()[/code]</p>
<p>Let's try executing our script again.</p>
<p>[code lang="bash" gutter="false"]\$ python barbaric-script.py[/code]</p>
<p>A histogram should pop up in a separate window:</p>
<p><a href="http://mathamy.files.wordpress.com/2014/02/barbaric.png"><img alt="barbaric" src="http://mathamy.files.wordpress.com/2014/02/barbaric.png" /></a></p>
<p>That's a lot of code (18 lines)! And we didn't even do anything
complicated - just parsed our data and plotted a histogram. Also, notice
that each time you tried to fix a bug or add a feature (like plotting
the histogram), you had to execute the entire script again, rather than
just the piece where you fixed the bug. That doesn't matter too much
since our data is fairly small and the script doesn't require much time
to execute, but it would be pretty annoying if our script took longer to
run.</p>
<p>Now let's try doing the same thing, but using pandas in an ipython
notebook. Use the terminal to run ipython notebook:</p>
<p>[code lang="bash" gutter="false"]\$ cd \~/Projects/ipython-pandas-whoa<br />
\$ ipython notebook[/code]</p>
<p>This will set up a local server on your computer, which will serve the
ipython notebooks that are in your working directory (right now you
don't have any) to http://127.0.0.1:8888. This should automatically open
up in your browser.</p>
<p>In the tab that opens in your browser, click "New Notebook". A new
ipython notebook will open up in another tab. A new cell will also open
up. Cells are places where you can write and execute code. This is what
a cell looks like:</p>
<p><a href="http://mathamy.files.wordpress.com/2014/02/ipythoncell.png"><img alt="ipythoncell" src="http://mathamy.files.wordpress.com/2014/02/ipythoncell.png" /></a></p>
<p>To allow matplotlib to post plots within your notebook, rather than
opening up a separate window (like when we executed our .py script),
type the following into the cell:</p>
<p>[code lang="python" gutter="false"]%matplotlib inline[/code]</p>
<p>Then to execute the cell, press shift+enter (which will execute the cell
your cursor is currently in and then automatically either move to the
next cell, if one exists, or open up a new cell). Once you press
shift+enter, your notebook should look like:</p>
<p><a href="http://mathamy.files.wordpress.com/2014/02/secondcell.png"><img alt="secondcell" src="http://mathamy.files.wordpress.com/2014/02/secondcell.png" /></a></p>
<p>In the next cell, import the packages we'll be using, namely
matplotlib.pyplot and pandas:</p>
<p>[code lang="python" gutter="false"]import matplotlib.pyplot as plt<br />
import pandas as pd[/code]</p>
<p>Press shift+enter again to execute the code (I'm going to stop telling
you to do this, but just assume that after each block of code you should
press shift+enter. If you get confused about what your notebook should
look like, look at my <a href="http://nbviewer.ipython.org/github/amygdalama/ipython-pandas-whoa/blob/master/ipython-pandas-whoa.ipynb">example notebook</a>.)</p>
<p>To process the iris data, we can use the built-in panda read_csv
parser. We can get to a easy-to-use data frame within three lines of
code!</p>
<p>[code lang="python" gutter="false"]url =
"http://mlr.cs.umass.edu/ml/machine-learning-databases/iris/iris.data"</p>
<p># Define our headers since the url doesn't contain explicit headers<br />
# I found these headers from looking at the documentation at<br />
#
http://mlr.cs.umass.edu/ml/machine-learning-databases/iris/iris.names<br />
headers = ['Sepal Length', 'Sepal Width', 'Petal Length', 'Petal
Width', 'Class']<br />
iris = pd.read_csv(url, header=None, names=headers)[/code]</p>
<p>Let's see what the data looks like.</p>
<p>[code lang="python" gutter="false"]iris[:3][/code]</p>
<p>You should see a beautifully formatted table! This is a pandas data
frame, which is similar to a data frame in R.</p>
<p><a href="http://mathamy.files.wordpress.com/2014/02/table.png"><img alt="table" src="http://mathamy.files.wordpress.com/2014/02/table.png" /></a></p>
<p>Now let's plot a histogram for the Sepal Length column.</p>
<p>[code lang="python" gutter="false"]# I use two brackets around 'Sepal
Length' to force pandas to make this<br />
# a data frame rather than just a series, which is like a numpy
array.<br />
# The brackets here aren't necessary, but makes printing
sepal_lengths<br />
# prettier and makes it easier for us to combine sepal_lengths with
other<br />
# data.<br />
sepal_lengths = iris[['Sepal Length']]</p>
<p># Make the plot pretty!<br />
pd.set_option('display.mpl_style', 'default')</p>
<p>sepal_lengths.hist()[/code]</p>
<p>[![quite_elegant][]][quite_elegant]</p>
<p>By this point it should be fairly obvious that ipython and pandas are
both awesome for data analysis! They make Python a much more serious
contender as a tool for data analysis by giving you quick and easy
access to your data. In this simple example, the barbaric-script.py was
18 lines of code (disregarding comments, etc) and comparatively the
ipython notebook with pandas was only 10!</p>
<p>For further reading, I definitely encourage you to check out Julia's
<a href="https://github.com/jvns/pandas-cookbook">pandas cookbook</a> (presented via ipython notebooks), on which
incidentally I'll be collaborating with her next week (eeeep)!</p>
<p>My code for this post can be found on my <a href="https://github.com/amygdalama/ipython-pandas-whoa">GitHub</a>, and the ipython
notebook can be easily viewed on <a href="http://nbviewer.ipython.org/github/amygdalama/ipython-pandas-whoa/blob/master/ipython-pandas-whoa.ipynb">NBViewer</a>.</p>                </article>
<p class="paginator">
    Page 1 / 1
</p>
            </aside><!-- /#featured -->
            </ol><!-- /#posts-list -->
            </section><!-- /#content -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>