<!DOCTYPE html>
<html lang="en">
<head>
        <title>Phonebook Exercise</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" href="../theme/css/main.css" type="text/css" />
        <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
   

        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="../css/ie.css"/>
                <script src="../js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="../css/ie6.css"/><![endif]-->

</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="..">Amy Hanlon </a></h1>
                <nav><ul>
                    <li><a href="..">Home</a></li>
                    <li><a href="../pages/about.html">About</a></li>
                    <li><a href="../pages/contact.html">Contact</a></li>
                    <li><a href="../pages/projects.html">Projects</a></li>
                    <li><a href="../pages/talks.html">Talks</a></li>
                </ul></nav>

        </header><!-- /#banner -->
        
<section id="content" class="body">    
    <h1 class="page-title">Phonebook Exercise</h1>
    <p>Let's make a command line tool for managing phonebook entries!</p>
<div class="toc">
<ul>
<li><a href="#prologue">Prologue</a></li>
<li><a href="#1-specifications">1. Specifications</a></li>
<li><a href="#2-planning-organizing">2. Planning &amp; Organizing</a></li>
<li><a href="#3-argument-parsing">3. Argument parsing</a><ul>
<li><a href="#31-intro-to-argument-parsing">3.1 Intro to argument parsing</a></li>
<li><a href="#32-rolling-your-own-argument-parser">3.2 Rolling your own argument parser</a></li>
<li><a href="#33-level-up-your-argument-parser">*3.3 Level up your argument parser</a><ul>
<li><a href="#331-unpack-the-arguments">*3.3.1 Unpack the arguments</a></li>
<li><a href="#332-error-handling">*3.3.2 Error handling</a></li>
<li><a href="#333-mapping-commands-to-functions">*3.3.3 Mapping commands to functions</a></li>
</ul>
</li>
<li><a href="#34-using-the-argparse-module">*3.4 Using the argparse module</a></li>
</ul>
</li>
<li><a href="#4-data-persistence">4. Data Persistence</a></li>
<li><a href="#5-partial-string-matching">5. Partial String Matching</a></li>
<li><a href="#6-writing-tests">6. Writing Tests</a></li>
</ul>
</div>
<h1 id="prologue">Prologue</h1>
<p>Depending on your learning style and experience level, you might get through all of these chapters. Or you might just get through the first one. That's okay! The main priority for this exercise is to write a lot of code and understand what the code you're writing does. Don't worry about "finishing", whatever that means.</p>
<p>If you don't understand a phrase or a line of code that I use, try googling it! A huge part of becoming a better programmer is learning how to google things you don't understand. If that doesn't help, ask me! I enjoy explaining things.</p>
<p>Most of the chapters are split up into sections roughly ordered by difficulty level. The more difficult sections are marked as optional. Also, feel free to skip or skim through the sections that cover content you're already familiar with.</p>
<h1 id="1-specifications">1. Specifications</h1>
<p>We'll make a <a href="http://en.wikipedia.org/wiki/Create,_read,_update_and_delete">CRUD</a> application that will support creating, retrieving, updating, and deleting phonebook entries consisting of a name and a phone number.</p>
<p>The application will have a command line interface supporting the following commands and behaviors:</p>
<div class="highlight"><pre><span class="gp">$</span> python phonebook.py create ex_phonebook
<span class="go">Created phonebook &#39;ex_phonebook.pb&#39; in the current directory.</span>

<span class="gp">$</span> python phonebook.py add <span class="s1">&#39;Jane Doe&#39;</span> <span class="s1">&#39;432 123 4321&#39;</span> ex_phonebook
<span class="go">Added an entry to ex_phonebook.pb:</span>
<span class="go">Jane Doe    432 123 4321</span>
<span class="gp">$</span> python phonebook.py add <span class="s1">&#39;Jane Lin&#39;</span> <span class="s1">&#39;509 123 4567&#39;</span> ex_phonebook
<span class="go">Added an entry to ex_phonebook.pb:</span>
<span class="go">Jane Lin    509 123 4567</span>
<span class="gp">$</span> python phonebook.py add <span class="s1">&#39;Jane Lin&#39;</span> <span class="s1">&#39;643 357 9876&#39;</span> ex_phonebook
<span class="go">Error: Jane Lin already exists in ex_phonebook. Use the &#39;update&#39; command to change this entry.</span>

<span class="gp">$</span> python phonebook.py update <span class="s1">&#39;Jane Lin&#39;</span> <span class="s1">&#39;643 357 9876&#39;</span> ex_phonebook
<span class="go">Updated an entry in ex_phonebook.pb.</span>
<span class="go">Previous entry:</span>
<span class="go">Jane Lin    509 123 4567</span>
<span class="go">New entry:</span>
<span class="go">Jane Lin    643 357 9876</span>

<span class="gp">$</span> python phonebook.py lookup <span class="s1">&#39;Jane&#39;</span> ex_phonebook
<span class="go">Jane Doe    432 123 4321</span>
<span class="go">Jane Lin    643 357 9876</span>

<span class="gp">$</span> python phonebook.py reverse-lookup <span class="s1">&#39;643 357 9876&#39;</span> ex_phonebook
<span class="go">Jane Lin    643 357 9876</span>

<span class="gp">$</span> python phonebook.py remove <span class="s1">&#39;Jane Doe&#39;</span> ex_phonebook
<span class="go">Removed an entry from ex_phonebook.pb:</span>
<span class="go">Jane Doe    432 123 4321</span>
<span class="gp">$</span> python phonebook.py remove <span class="s1">&#39;John Doe&#39;</span> ex_phonebook
<span class="go">Error: &#39;John Doe&#39; does not exist in ex_phonebook.pb</span>
</pre></div>


<h1 id="2-planning-organizing">2. Planning &amp; Organizing</h1>
<p>What are the functions that you'll need for your program? What arguments will each of those functions need? Write a skeleton program that has those functions definitions, but where the functions just <code>pass</code>, rather than actually doing anything.</p>
<p>Here is an example skeleton program with a function definition for <code>create</code>ing a phonebook. You'll need more functions, too, but this is a start:</p>
<div class="highlight"><pre><span class="k">def</span> <span class="nf">create_phonebook</span><span class="p">(</span><span class="n">phonebook_name</span><span class="p">):</span>
    <span class="c"># placeholder for create_phonebook function</span>
    <span class="k">pass</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>


<p>If you don't know why I included an <code>if __name__ == '__main__'</code> statement, try googling it! Now is an excellent time to find out.</p>
<h1 id="3-argument-parsing">3. Argument parsing</h1>
<p>If you don't know how to parse arguments passed to the Python interpreter from the command line, see if you can figure out how to do it by googling. Maybe google "python command line arguments" as a start.</p>
<h2 id="31-intro-to-argument-parsing">3.1 Intro to argument parsing</h2>
<p>Arguments passed to Python scripts from the command line are accessible using the <code>sys</code> module. Here's a simple example script that prints out the arguments passed to the Python interpreter:</p>
<div class="highlight"><pre><span class="c"># ex.py</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="k">print</span> <span class="s">&quot;The arguments given to the interpreter are: &quot;</span>
<span class="k">print</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span>
</pre></div>


<p>What happens when you execute the script giving it some arguments?</p>
<div class="highlight"><pre><span class="gp">$</span> python ex.py red flowers hi
<span class="go">The arguments given to the interpreter are:</span>
<span class="go">[&#39;ex.py&#39;, &#39;red&#39;, &#39;flowers&#39;, &#39;hi&#39;]</span>
</pre></div>


<p>So <code>sys.argv</code> is a list, containing the name of the script (<code>'ex.py'</code>), and then the three arguments we passed, all represented as strings.</p>
<h2 id="32-rolling-your-own-argument-parser">3.2 Rolling your own argument parser</h2>
<p>For your phonebook application, you might choose to manually parse your arguments, which could look something like this:</p>
<div class="highlight"><pre><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span>
    <span class="n">script</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>    <span class="c"># name of script is first arg</span>
    <span class="n">command</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>   <span class="c"># the next arg will be the main command</span>

    <span class="k">if</span> <span class="n">command</span> <span class="o">==</span> <span class="s">&#39;create&#39;</span><span class="p">:</span>
        <span class="n">phonebook_name</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">create_phonebook</span><span class="p">(</span><span class="n">phonebook_name</span><span class="p">)</span>    <span class="c"># create_phonebook function should be defined above</span>

    <span class="k">elif</span> <span class="n">command</span> <span class="o">==</span> <span class="s">&#39;add&#39;</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">number</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">phonebook_name</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">add_entry</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">phonebook_name</span><span class="p">)</span>     <span class="c"># add_entry function should be defined above</span>

    <span class="c"># define similar elif statements for update, lookup,</span>
    <span class="c"># reverse-lookup, and delete commands</span>
</pre></div>


<p>If you're not sure how the <code>pop</code> method works, google it!</p>
<p>There are some potential issues with this code. Try to figure out what they are. Try to improve the code.</p>
<h2 id="33-level-up-your-argument-parser">*3.3 Level up your argument parser</h2>
<p>The argument parser we wrote in section 3.2 wasn't really that great. There's lots of duplicate logic, and it wouldn't be too easy to add or remove a command from our program. Let's try making it better with some more advanced techniques.</p>
<h4 id="331-unpack-the-arguments">*3.3.1 Unpack the arguments</h4>
<p>Use tuple unpacking to bind variable names to the arguments in one line of code rather than in many lines of code. For example, we can turn this:</p>
<div class="highlight"><pre><span class="n">name</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">number</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>


<p>into this:</p>
<div class="highlight"><pre><span class="n">name</span><span class="p">,</span> <span class="n">number</span> <span class="o">=</span> <span class="n">args</span>
</pre></div>


<p>This works even though <code>args</code> is a list and not a tuple!</p>
<h4 id="332-error-handling">*3.3.2 Error handling</h4>
<p>What happens when a user passes an incorrect number of arguments? Try giving your program too few arguments. Now try with too many arguments.</p>
<p>Our users might find it useful for us to <code>raise</code> or <code>print</code> descriptive error messages if the number of arguments is incorrect. How could we add this to our program?</p>
<p>If you don't know how to <code>raise</code> exceptions and you want to learn, now is a great time! google it!</p>
<h4 id="333-mapping-commands-to-functions">*3.3.3 Mapping commands to functions</h4>
<p>This section is a bit more advanced than the others. Feel free to skip it!</p>
<p>Having an <code>if</code>/<code>elif</code> statement for each command is kind of ugly. Instead, try creating a dictionary mapping the commands to their corresponding functions, like this:</p>
<div class="highlight"><pre><span class="n">command_funcs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&#39;create&#39;</span> <span class="p">:</span> <span class="n">create</span><span class="p">,</span>  <span class="c"># create is a function defined elsewhere</span>
    <span class="s">&#39;add&#39;</span> <span class="p">:</span> <span class="n">add</span><span class="p">,</span>
    <span class="s">&#39;update&#39;</span> <span class="p">:</span> <span class="n">update</span><span class="p">,</span>
    <span class="s">&#39;delete&#39;</span> <span class="p">:</span> <span class="n">delete</span><span class="p">,</span>
    <span class="s">&#39;lookup&#39;</span> <span class="p">:</span> <span class="n">lookup</span><span class="p">,</span>
    <span class="s">&#39;reverse-lookup&#39;</span> <span class="p">:</span> <span class="n">reverse_lookup</span>
<span class="p">}</span>
</pre></div>


<p>Having functions as values in a dictionary might be pretty foreign at first, but it can be really useful, as we're about to see!</p>
<p>We can look up the appropriate function for the given command like this:</p>
<div class="highlight"><pre><span class="n">func</span> <span class="o">=</span> <span class="n">command_funcs</span><span class="p">[</span><span class="n">command</span><span class="p">]</span>
</pre></div>


<p>Here the variable <code>command</code> is the main command you grabbed from the command line arguments. <code>func</code> is the function associated with <code>command</code> in the <code>command_funcs</code> dictionary we created.</p>
<p>To invoke <code>func</code>, we could try:</p>
<div class="highlight"><pre><span class="n">func</span><span class="p">()</span>
</pre></div>


<p>But we need to figure out how to pass the appropriate arguments to <code>func</code>. <code>func</code> could be any of <code>create</code>, <code>add</code>, <code>update</code>, <code>delete</code>, etc. These functions take varying number of arguments. So how can we pass the correct number of arguments to <code>func</code> without a messy <code>if</code> statement?</p>
<p>This is where the super awesome <code>*args</code> comes in handy. Try reading up on <code>*args</code>. Then try figuring out how to use it to pass <code>func</code> the rest of the arguments that were given on the command line. Try to figure out how to handle when an incorrect number of arguments is passed.</p>
<h2 id="34-using-the-argparse-module">*3.4 Using the <code>argparse</code> module</h2>
<p>If you already know how to manually write an argument parser, try reading this section to learn about the <code>argparse</code> module.</p>
<h1 id="4-data-persistence">4. Data Persistence</h1>
<h1 id="5-partial-string-matching">5. Partial String Matching</h1>
<h1 id="6-writing-tests">6. Writing Tests</h1>
</section>
        <section id="extras" class="body">
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">

        </footer><!-- /#contentinfo -->

    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
        var pageTracker = _gat._getTracker("UA-48330831-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>
<script type="text/javascript">
    var disqus_shortname = 'mathamy';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>